{
  "$schema":"schema.json",
  "version": "0.1.0",
  "definitions": {
    "absolute-path": { "anyOf": [
      { "type": "string", "pattern":""},
      {
        "type": "object",
        "properties": {}
      }
    ]},
    "relative-path": { "anyOf": [
      { "type": "string", "pattern":""},
      { 
        "type": "object",
        "properties": {}
      }
    ]},
    "configuration-reference": { "anyOf": [
      { "type": "string", "pattern":""},
      { 
        "type": "object",
        "properties": {}
      }
    ]},
    "commandline-option-prefix": { "type":"string", "pattern":"" },
    "commandline-option": { "anyOf": [
      { "$ref": "#/definitions/commandline-option-prefix" },
      { "type": "object",
        "properties": {
          "prefix": { "$ref": "#/definitions/commandline-option-prefix" },
          "value": { "anyOf": [
            { "$ref": "#/definitions/configuration-base-type" },
            { "type":"array",
              "items": { "$ref": "#/definitions/configuration-base-type" } 
            } 
          ]}
        }
      }
    ]},
    "configuration-string": { "allOf": [
      { "type": "string" },
      { "not": { "anyOf": [
        { "$ref": "#/definitions/absolute-path" },
        { "$ref": "#/definitions/relative-path" },
        { "$ref": "#/definitions/configuration-reference" },
        { "$ref": "#/definitions/commandline-option" }
      ]}}
    ]},
    "configuration-base-type": { "anyOf": [
      { "$ref": "#/definitions/absolute-path" },
      { "$ref": "#/definitions/relative-path" },
      { "$ref": "#/definitions/configuration-reference" },
      { "$ref": "#/definitions/commandline-option" },
      { "$ref": "#/definitions/configuration-string" }
    ]},
    "short-name": { "type": "string", "pattern": "^[a-z0-9-_]+" },
    "version": { "type": "string", "pattern": "^[0-9]+.[0-9]+.[0-9]+$" },
    "languages": { "type": "string", "enum": ["c", "js", "matlab", "opencl", "webcl"] },
    "language-list": {
      "type": "array",
      "items": { "$ref": "#/definitions/languages" },
      "uniqueItems": true
    },
    "input-size": { 
      "type": "object",
      "properties": {
        "small": { "type": ["string", "number"] },
        "medium": { "type": ["string", "number"] },
        "large": { "type": ["string", "number"] }
      },
      "required": ["small", "medium"]
    },
    "file-path": { "anyOf": [
      { "$ref": "#/definitions/absolute-path" },
      { "$ref": "#/definitions/relative-path" }
    ]},
    "file-path-list": { 
      "type": "array",
      "items": { "$ref": "#/definitions/file-path" }
    },

    "benchmark": { 
      "type": "object",
      "properties":{
        "name": { "type": "string" },
        "short-name": { "$ref": "#/definitions/short-name" },
        "description": { "type": "string" },
        "version": { "$ref": "#/definitions/version" },
        "languages": { "$ref": "#/definitions/language-list" },
        "input-size": { "$ref": "#/definitions/input-size" },
        "random-seed": { "type": "number" } 
      },
      "required": ["short-name", "version", "languages", "input-size"]
    },
    
    "compiler-commandline-option": { "anyOf": [
      { "$ref": "#/definitions/absolute-path" },
      { "$ref": "#/definitions/relative-path" },
      { "$ref": "#/definitions/configuration-reference" },
      { "$ref": "#/definitions/commandline-option" }
    ]},
    "compiler-commandline-option-list": {
      "type": "array",
      "items": { "$refs": "#/definitions/compiler-commandline-option" }
    },
    "compiler": {
      "type": "object",
      "properties": {
        "short-name": { "$ref": "#/definitions/short-name" },
        "supported-languages": { "$ref": "#/definitions/language-list" },
        "runner-name": { "type": "string" },
        "options": { "$ref": "#/definitions/compiler-commandline-option-list" },
      },
      "required": ["short-name", "supported-languages", "runner-name", "options"]
    },
    "compiler-list": {
      "type": "array",
      "items": { "$refs": "#/definitions/short-name" },
      "uniqueItems": true
    },
    "runner-arguments": {
      "type": "object",
      "properties": {
        "size": { "$ref": "#/definitions/commandline-option" }
      },
      "required": [ "size" ]
    },
    "implementation": {
      "type": "object",
      "properties": {
        "short-name": { "$ref": "#/definitions/short-name" },
        "description": { "type": "string" },
        "language": { "$ref": "#/definitions/language" },
        "supported-compilers": { "$ref": "#/definitions/compiler-list" },
        "core-source-files": { "$ref": "#/definitions/file-path-list" },
        "runner-source-file": { "$ref": "#/definitions/file-path" },
        "runner-arguments": { "$ref": "#/definitions/runner-arguments" },
        "libraries": { "$ref": "#/definitions/file-path-list" },
        "include-directories": { "$ref": "#/definitions/file-path-list" },
        "static-parameters": {},
        "dynamic-parameters": {},
        "static-dependencies": {},
        "dynamic-dependencies": {}
      },
      "required": [ "short-name", "language", "supported-compilers", "core-source-files", "runner-source-file", "runner-arguments"] 
    },
    "experiment": {},
    "result": {}
  }
}
